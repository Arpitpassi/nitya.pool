<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nitya Pool Manager</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Urbanist:wght@400;500;600;700&family=Raleway:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="src/styles.css">
</head>
<body>
  <!-- Geometric Decorations -->
  <div class="geometric-decor top-right"></div>
  <div class="geometric-decor bottom-left"></div>

  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <div class="sidebar w-64 p-6 text-gray-900">
      <div class="flex items-center mb-8">
        <div class="w-10 h-10 bg-white bg-opacity-50 rounded-xl flex items-center justify-center mr-3">
          <svg class="w-6 h-6 text-gray-900" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z"></path>
          </svg>
        </div>
        <h1 class="text-xl font-bold">Nityaprotocol</h1>
      </div>
      <div class="mt-8 pt-6 border-t border-gray-900 border-opacity-20">
        <a href="https://prices.ardrive.io/" target="_blank" class="flex items-center px-4 py-3 rounded-lg text-gray-900 bg-white bg-opacity-20 hover:bg-opacity-30 transition-all duration-300 text-sm font-medium">
          <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
          </svg>
          Turbo Price Calculator
        </a>
        <a href="https://discord.gg/wbhP7ND4" id="support-btn" class="flex items-center px-4 py-3 rounded-lg text-gray-900 bg-white bg-opacity-20 hover:bg-opacity-30 transition-all duration-300 text-sm font-medium">
          <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"></path>
          </svg>
          Support
        </a>
      </div>
    </div>

    <!-- Main Content -->
    <div class="flex-1 p-6">
      <div id="wallet-section" class="mb-6">
        <div class="glass-card rounded-2xl p-6 text-center">
          <h2 class="text-2xl font-bold mb-4 text-gray-900">Welcome to Nitya Pool Manager!</h2>
          <p id="wallet-status" class="mb-4 text-gray-600">Connect your Arweave wallet to continue</p>
          <button id="connect-wallet" class="btn-primary px-6 py-3 rounded-xl font-semibold">Connect Wallet</button>
          <button id="disconnect-wallet" class="btn-secondary px-6 py-3 rounded-xl font-semibold hidden ml-4">Disconnect</button>
        </div>
      </div>

      <div id="dashboard" class="hidden">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
          <div class="stat-card rounded-2xl p-6">
            <h3 class="text-sm text-gray-600 mb-2 font-semibold uppercase tracking-wide">Total Pools</h3>
            <p id="total-pools" class="text-3xl font-bold text-gray-900">0</p>
          </div>
          <div class="stat-card rounded-2xl p-6">
            <h3 class="text-sm text-gray-600 mb-2 font-semibold uppercase tracking-wide">Active Pools</h3>
            <p id="active-pools" class="text-3xl font-bold text-gray-900">0</p>
          </div>
        </div>

        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-gray-900">Your Deployment Pools</h2>
          <button id="create-pool-btn" class="btn-primary px-6 py-3 rounded-xl font-semibold">+ New Pool</button>
        </div>
        <div id="pools-grid" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3"></div>
      </div>
    </div>
  </div>

  <!-- Create Pool Modal -->
  <div id="create-modal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4 sm:p-6">
    <div class="modal-content rounded-3xl p-6 sm:p-8 w-full max-w-2xl">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold text-gray-900">Create New Pool</h3>
        <button id="close-create-modal" class="close-btn">×</button>
      </div>
      <form id="create-pool-form" class="space-y-4">
        <input type="hidden" id="server-url" value="https://vmi2561282.contaboserver.net">
        <input type="text" id="pool-name" placeholder="Pool Name" class="w-full input-field rounded-xl p-3" required>
        <input type="password" id="pool-password" placeholder="Pool Password" class="w-full input-field rounded-xl p-3" required>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <input type="datetime-local" id="start-time" class="input-field rounded-xl p-3" required>
          <input type="datetime-local" id="end-time" class="input-field rounded-xl p-3" required>
        </div>
        <input type="number" id="usage-cap" step="0.000000000001" min="0" placeholder="Usage Cap (Credits)" class="w-full input-field rounded-xl p-3" required>
        <div>
          <label for="whitelist" class="block text-sm font-medium text-gray-700 mb-2">Whitelisted Addresses (one per line, 43-character Arweave addresses)</label>
          <textarea id="whitelist" rows="4" placeholder="Enter one Arweave address per line" class="w-full input-field rounded-xl p-3 whitelist-textarea"></textarea>
          <input type="file" id="whitelist-file" accept=".json" class="mt-2">
          <p class="text-xs text-gray-500 mt-1">Enter addresses manually or upload a JSON file with an array of addresses.</p>
          <div id="whitelist-preview-create" class="address-preview mt-3"></div>
        </div>
        <div>
          <label for="sponsor-info" class="block text-sm font-medium text-gray-700 mb-2">Sponsor Information</label>
          <textarea id="sponsor-info" rows="4" placeholder="Enter sponsor information" class="w-full input-field rounded-xl p-3 whitelist-textarea" required></textarea>
        </div>
        <div class="flex flex-col sm:flex-row sm:space-x-3 space-y-3 sm:space-y-0">
          <button type="submit" id="create-submit-btn" class="flex-1 btn-primary py-3 rounded-xl font-semibold">Create Pool</button>
          <button type="button" id="cancel-create" class="px-6 btn-secondary py-3 rounded-xl font-semibold">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Pool Modal -->
  <div id="edit-modal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
    <div class="modal-content rounded-3xl p-8 max-w-lg w-full">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold text-gray-900">Edit Pool</h3>
        <button id="close-edit-modal" class="close-btn">×</button>
      </div>
      <form id="edit-pool-form" class="space-y-4">
        <input type="hidden" id="edit-pool-id">
        <input type="password" id="edit-pool-password" placeholder="Pool Password" class="w-full input-field rounded-xl p-3" required>
        <div class="grid grid-cols-2 gap-4">
          <input type="datetime-local" id="edit-start-time" class="input-field rounded-xl p-3">
          <input type="datetime-local" id="edit-end-time" class="input-field rounded-xl p-3">
        </div>
        <input type="number" id="edit-usage-cap" step="0.000000000001" min="0" placeholder="Usage Cap" class="w-full input-field rounded-xl p-3">
        <div>
          <label for="edit-whitelist" class="block text-sm font-medium text-gray-700 mb-2">Whitelisted Addresses (one per line, 43-character Arweave addresses)</label>
          <textarea id="edit-whitelist" rows="4" placeholder="Enter one Arweave address per line" class="w-full input-field rounded-xl p-3 whitelist-textarea"></textarea>
          <input type="file" id="edit-whitelist-file" accept=".json" class="mt-2">
          <p class="text-xs text-gray-500 mt-1">Enter addresses manually or upload a JSON file with an array of addresses.</p>
          <div id="whitelist-preview-edit" class="address-preview mt-3"></div>
        </div>
        <div class="flex space-x-3">
          <button type="submit" id="edit-submit-btn" class="flex-1 btn-primary py-3 rounded-xl font-semibold">Update Pool</button>
          <button type="button" id="cancel-edit" class="px-6 btn-secondary py-3 rounded-xl font-semibold">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- View Details Modal -->
  <div id="details-modal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
    <div class="details-modal-content rounded-3xl p-8 max-w-7xl w-full max-h-[90vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold text-gray-900">Pool Details</h3>
        <button id="close-details" class="close-btn">×</button>
      </div>
      <div id="pool-details-content" class="space-y-6"></div>
      <div class="pool-details-section rounded-2xl p-6 mt-6">
        <h4 class="font-bold text-gray-900 mb-4 text-lg">Revoke Access</h4>
        <input type="text" id="revoke-address" placeholder="Enter wallet address to revoke" class="w-full input-field rounded-xl p-3 mb-4">
        <input type="password" id="revoke-password" placeholder="Pool Password" class="w-full input-field rounded-xl p-3 mb-4">
        <button onclick="revokeAccess()" class="w-full btn-warning py-2 rounded-lg text-sm font-semibold transition-all">Revoke Access</button>
      </div>
      <div class="pool-details-section rounded-2xl p-6 mt-6">
        <h4 class="font-bold text-gray-900 mb-4 text-lg">Download Wallet</h4>
        <input type="password" id="download-password" placeholder="Pool Password" class="w-full input-field rounded-xl p-3 mb-4">
        <button onclick="downloadWallet()" class="w-full btn-success py-2 rounded-lg text-sm font-semibold transition-all">Download Wallet</button>
      </div>
      <div class="pool-details-section rounded-2xl p-6 mt-6">
        <h4 class="font-bold text-gray-900 mb-4 text-lg">Delete Pool</h4>
        <button onclick="deletePoolConfirm()" class="w-full btn-delete py-2 rounded-lg text-sm font-semibold transition-all">Delete Pool</button>
      </div>
    </div>
  </div>

  <!-- Wallet Choice Modal -->
  <div id="wallet-choice-modal" class="backgroundLayer hidden">
    <div class="wrapper">
      <h2>Choose a Wallet</h2>
      <button class="button" id="connect-browser-wallet">Connect with Browser Wallet</button>
      <button class="button" id="connect-beacon">Connect with Beacon</button>
      <button class="button" id="cancel-connect">Cancel</button>
    </div>
  </div>

  <div id="toast-container" class="toast-container"></div>

  <script type="module" src="src/main.js"></script>
</body>
</html>